
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://hpinc.github.io/ml-git/api/api_scripts/multiple_datasets_notebook/multiple_datasets/">
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.4.0">
    
    
      
        <title>Multiple datasets - ML-Git</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.69437709.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.cbb835fc.min.css">
        
          
          
          <meta name="theme-color" content="#02a6f2">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="light-blue" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#storage-reuse-with-multiple-datasets" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="ML-Git" class="md-header__button md-logo" aria-label="ML-Git" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ML-Git
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Multiple datasets
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        Home
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../../developer_info/" class="md-tabs__link">
      Contributing to ML-Git
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="ML-Git" class="md-nav__button md-logo" aria-label="ML-Git" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    ML-Git
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1">
          Home
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Home" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Home
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../first_steps/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../advanced_scenarios/" class="md-nav__link">
        Additional Use Cases
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_4" type="checkbox" id="__nav_1_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_4">
          Architecture
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Architecture" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_4">
          <span class="md-nav__icon md-icon"></span>
          Architecture
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../mlgit_internals/" class="md-nav__link">
        Design
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../centralized_cache_and_objects/" class="md-nav__link">
        Cache and Objects
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../mutability_helper/" class="md-nav__link">
        Mutability Helper
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../plugins/" class="md-nav__link">
        Plugins
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../resources_initialization/" class="md-nav__link">
        Resources Initialization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../tabular_data/tabular_data/" class="md-nav__link">
        Working With Tabular Data
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_5" type="checkbox" id="__nav_1_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_5">
          Supported Storages
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Supported Storages" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_5">
          <span class="md-nav__icon md-icon"></span>
          Supported Storages
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../storage_configurations/" class="md-nav__link">
        Configurations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../minio_s3_configuration/" class="md-nav__link">
        MinIO
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../aws_s3_configuration/" class="md-nav__link">
        S3
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../azure_configurations/" class="md-nav__link">
        Azure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../gdrive_configurations/" class="md-nav__link">
        Google Drive
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_6" type="checkbox" id="__nav_1_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_6">
          Commands
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Commands" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_6">
          <span class="md-nav__icon md-icon"></span>
          Commands
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../mlgit_commands/" class="md-nav__link">
        Using ML-Git CLI
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_6_2" type="checkbox" id="__nav_1_6_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_6_2">
          Using ML-Git API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Using ML-Git API" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_6_2">
          <span class="md-nav__icon md-icon"></span>
          Using ML-Git API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../quick_start/" class="md-nav__link">
        Quick Start
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../" class="md-nav__link">
        Methods
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../downloadable_environment/" class="md-nav__link">
        Docker Environment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../step_by_step_guides/" class="md-nav__link">
        ML-Git Step-by-Step Guides
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../developer_info/" class="md-nav__link">
        Contributing to ML-Git
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


  <h1>Multiple datasets</h1>

<h2 id="storage-reuse-with-multiple-datasets">Storage reuse with multiple datasets<a class="headerlink" href="#storage-reuse-with-multiple-datasets" title="Permanent link">&para;</a></h2>
<h4 id="this-notebook-describes-a-storage-reuse-scenario-with-multiple-datasets-containing-common-datapoints">This notebook describes a storage reuse scenario with multiple datasets containing common datapoints.<a class="headerlink" href="#this-notebook-describes-a-storage-reuse-scenario-with-multiple-datasets-containing-common-datapoints" title="Permanent link">&para;</a></h4>
<p>When the same file is used in multiple datasets, that file will be added to the bucket only once, in order to optimize the space usage in the bucket. To exemplify this use case, two entities will be created: the people entity contains 10 images with faces of people, while famous entity contains 7 images with faces of famous people, being 5 of them also contained in the people entity.</p>
<p>This way, when sending the files to the repository, the 5 images that are being used in the two entities will not be duplicated in the bucket. The two entities will refer to the same image stored in the bucket.</p>
<h4 id="to-start-using-the-ml-git-api-we-need-to-import-it-into-our-script">To start using the ml-git api we need to import it into our script<a class="headerlink" href="#to-start-using-the-ml-git-api-we-need-to-import-it-into-our-script" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">ml_git.api</span> <span class="kn">import</span> <span class="n">MLGitAPI</span>
</code></pre></div>
<h4 id="after-that-we-define-some-variables-that-will-be-used-by-the-notebook">After that, we define some variables that will be used by the notebook<a class="headerlink" href="#after-that-we-define-some-variables-that-will-be-used-by-the-notebook" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># The type of entity we are working on</span>
<span class="n">entity</span> <span class="o">=</span> <span class="s1">&#39;datasets&#39;</span>

<span class="c1"># The entity name we are working on</span>
<span class="n">entity_name_people</span> <span class="o">=</span> <span class="s1">&#39;people_faces&#39;</span>

<span class="c1"># The entity name we are working on</span>
<span class="n">entity_name_famous</span> <span class="o">=</span> <span class="s1">&#39;famous_faces&#39;</span>
</code></pre></div>
<h4 id="to-start-lets-take-into-account-that-you-have-a-repository-with-git-settings-to-make-the-clone-if-this-is-not-your-scenario-you-will-need-to-configure-ml-git-outside-this-notebook-at-the-moment-the-api-does-not-have-the-necessary-methods-to-perform-this-configuration">To start, let's take into account that you have a repository with git settings to make the clone. If this is not your scenario, you will need to configure ml-git outside this notebook (At the moment the api does not have the necessary methods to perform this configuration).<a class="headerlink" href="#to-start-lets-take-into-account-that-you-have-a-repository-with-git-settings-to-make-the-clone-if-this-is-not-your-scenario-you-will-need-to-configure-ml-git-outside-this-notebook-at-the-moment-the-api-does-not-have-the-necessary-methods-to-perform-this-configuration" title="Permanent link">&para;</a></h4>
<h4 id="or-you-can-manually-configure-the-repository-using-the-command-line-following-the-steps-in-the-first-project-documentation">Or you can manually configure the repository using the command line, following the steps in the <a href="https://github.com/HPInc/ml-git/blob/development/docs/first_project.md">First Project</a> documentation.<a class="headerlink" href="#or-you-can-manually-configure-the-repository-using-the-command-line-following-the-steps-in-the-first-project-documentation" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="n">repository_url</span> <span class="o">=</span> <span class="s1">&#39;/local_ml_git_config_server.git&#39;</span>
<span class="n">api</span> <span class="o">=</span> <span class="n">MLGitAPI</span><span class="p">()</span>

<span class="n">api</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="n">repository_url</span><span class="p">)</span>
</code></pre></div>
<pre><code>INFO - Metadata Manager: Metadata init [/local_server.git/] @ [/api_scripts/multiple_datasets_notebook/tmpfyoxmtjy/mlgit/.ml-git/datasets/metadata]
INFO - Metadata Manager: Metadata init [/local_server.git/] @ [/api_scripts/multiple_datasets_notebook/tmpfyoxmtjy/mlgit/.ml-git/models/metadata]
INFO - Metadata Manager: Metadata init [/local_server.git/] @ [/api_scripts/multiple_datasets_notebook/tmpfyoxmtjy/mlgit/.ml-git/labels/metadata]
INFO - Metadata: Successfully loaded configuration files!
</code></pre>
<h4 id="create-the-people-dataset">Create the people dataset<a class="headerlink" href="#create-the-people-dataset" title="Permanent link">&para;</a></h4>
<p><img alt="dataset" src="../people_faces/people_faces.jpg" /></p>
<div class="highlight"><pre><span></span><code><span class="err">!</span><span class="n">ml</span><span class="o">-</span><span class="n">git</span> <span class="n">datasets</span> <span class="n">create</span> <span class="n">people_faces</span> <span class="o">--</span><span class="n">categories</span><span class="o">=</span><span class="s2">&quot;computer-vision, images&quot;</span> <span class="o">--</span><span class="n">bucket</span><span class="o">-</span><span class="n">name</span><span class="o">=</span><span class="n">faces_bucket</span> <span class="o">--</span><span class="n">mutability</span><span class="o">=</span><span class="n">strict</span> <span class="o">--</span><span class="n">import</span><span class="o">=</span><span class="s1">&#39;people_faces&#39;</span> <span class="o">--</span><span class="n">unzip</span>
</code></pre></div>
<pre><code>[?25hâ ‹ Importing filesâ ™ Importing filesINFO - MLGit: Unzipping files
INFO - MLGit: Dataset artifact created.
[?25h
</code></pre>
<h4 id="we-can-now-proceed-with-the-necessary-steps-to-send-the-new-data-to-storage">We can now proceed with the necessary steps to send the new data to storage.<a class="headerlink" href="#we-can-now-proceed-with-the-necessary-steps-to-send-the-new-data-to-storage" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="n">api</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">entity</span><span class="p">,</span> <span class="n">entity_name_people</span><span class="p">,</span> <span class="n">bumpversion</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
<pre><code>INFO - Metadata Manager: Pull [/api_scripts/multiple_datasets_notebook/.ml-git/datasets/metadata]
INFO - Repository: datasets adding path [/api_scripts/multiple_datasets_notebook/datasets/people_faces] to ml-git index
files: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10.0/10.0 [00:00&lt;00:00, 646files/s]


â ‹ Creating hard links in cacheâ ™ Creating hard links in cache

files: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10.0/10.0 [00:00&lt;00:00, 32.7kfiles/s]
</code></pre>
<p>Commit the changes</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Custom commit message</span>
<span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;Commit example&#39;</span>

<span class="n">api</span><span class="o">.</span><span class="n">commit</span><span class="p">(</span><span class="n">entity</span><span class="p">,</span> <span class="n">entity_name_people</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
</code></pre></div>
<pre><code>â ‹ Updating indexâ ™ Updating index Checking removed filesâ ™ Checking removed files Commit manifestâ ™ Commit manifest

INFO - Metadata Manager: Commit repo[/api_scripts/multiple_datasets_notebook/.ml-git/datasets/metadata] --- file[people_faces]
</code></pre>
<h4 id="as-we-are-using-minio-locally-to-store-the-data-in-the-bucket-we-were-able-to-check-the-number-of-files-that-are-in-the-local-bucket">As we are using MinIO locally to store the data in the bucket, we were able to check the number of files that are in the local bucket.<a class="headerlink" href="#as-we-are-using-minio-locally-to-store-the-data-in-the-bucket-we-were-able-to-check-the-number-of-files-that-are-in-the-local-bucket" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">os</span>

<span class="k">def</span> <span class="nf">get_bucket_files_count</span><span class="p">():</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of files on bucket: &quot;</span> <span class="o">+</span>  <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">&#39;../../data/faces_bucket&#39;</span><span class="p">))))</span>
</code></pre></div>
<h4 id="amount-of-files-in-the-buket-before-pushing-the-people-dataset">Amount of files in the buket before pushing the people dataset<a class="headerlink" href="#amount-of-files-in-the-buket-before-pushing-the-people-dataset" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="n">get_bucket_files_count</span><span class="p">()</span>
</code></pre></div>
<pre><code>Number of files on bucket: 0
</code></pre>
<p>As we have not yet uploaded any version of our dataset, the bucket is empty.</p>
<h4 id="pushing-the-people-dataset">Pushing the people dataset<a class="headerlink" href="#pushing-the-people-dataset" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="n">api</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">entity</span><span class="p">,</span> <span class="n">entity_name_people</span><span class="p">)</span>
</code></pre></div>
<pre><code>files: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 20.0/20.0 [00:00&lt;00:00, 92.3files/s]


â ‹ Pushing metadata to the git repositoryâ ™ Pushing metadata to the git repository
</code></pre>
<h4 id="amount-of-files-in-the-buket-after-pushing-the-people-dataset">Amount of files in the buket after pushing the people dataset<a class="headerlink" href="#amount-of-files-in-the-buket-after-pushing-the-people-dataset" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="n">get_bucket_files_count</span><span class="p">()</span>
</code></pre></div>
<pre><code>Number of files on bucket: 20
</code></pre>
<p>After sending the data, we can observe the presence of 20 blobs related to the 10 images that were versioned. In this case, two blobs were added for each image in our dataset.</p>
<h4 id="create-the-famous-dataset">Create the famous dataset<a class="headerlink" href="#create-the-famous-dataset" title="Permanent link">&para;</a></h4>
<p>Let's create our second dataset that has some images equals to the first dataset.</p>
<p><img alt="dataset" src="../famous_faces/famous_faces.jpg" /></p>
<div class="highlight"><pre><span></span><code><span class="err">!</span><span class="n">ml</span><span class="o">-</span><span class="n">git</span> <span class="n">datasets</span> <span class="n">create</span> <span class="n">famous_faces</span> <span class="o">--</span><span class="n">categories</span><span class="o">=</span><span class="s2">&quot;computer-vision, images&quot;</span> <span class="o">--</span><span class="n">bucket</span><span class="o">-</span><span class="n">name</span><span class="o">=</span><span class="n">faces_bucket</span> <span class="o">--</span><span class="n">mutability</span><span class="o">=</span><span class="n">strict</span> <span class="o">--</span><span class="n">import</span><span class="o">=</span><span class="s1">&#39;famous_faces&#39;</span> <span class="o">--</span><span class="n">unzip</span>
</code></pre></div>
<pre><code>[?25hâ ‹ Importing filesâ ™ Importing filesINFO - MLGit: Unzipping files
INFO - MLGit: Dataset artifact created.
[?25h
</code></pre>
<h4 id="we-can-now-proceed-with-the-necessary-steps-to-send-the-new-data-to-storage_1">We can now proceed with the necessary steps to send the new data to storage.<a class="headerlink" href="#we-can-now-proceed-with-the-necessary-steps-to-send-the-new-data-to-storage_1" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="n">api</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">entity</span><span class="p">,</span> <span class="n">entity_name_famous</span><span class="p">,</span> <span class="n">bumpversion</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
<pre><code>INFO - Metadata Manager: Pull [/api_scripts/multiple_datasets_notebook/.ml-git/datasets/metadata]
INFO - Repository: datasets adding path [/api_scripts/multiple_datasets_notebook/datasets/famous_faces] to ml-git index
files: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 7.00/7.00 [00:00&lt;00:00, 703files/s]


â ‹ Creating hard links in cacheâ ™ Creating hard links in cache

files: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 7.00/7.00 [00:00&lt;00:00, 40.2kfiles/s]
</code></pre>
<p>Commit the changes</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Custom commit message</span>
<span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;Commit example&#39;</span>

<span class="n">api</span><span class="o">.</span><span class="n">commit</span><span class="p">(</span><span class="n">entity</span><span class="p">,</span> <span class="n">entity_name_famous</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
</code></pre></div>
<pre><code>â ‹ Updating indexâ ™ Updating index Checking removed filesâ ™ Checking removed files Commit manifestâ ™ Commit manifest

INFO - Metadata Manager: Commit repo[/api_scripts/multiple_datasets_notebook/.ml-git/datasets/metadata] --- file[famous_faces]
</code></pre>
<p>And finally, sending the data</p>
<div class="highlight"><pre><span></span><code><span class="n">api</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">entity</span><span class="p">,</span> <span class="n">entity_name_famous</span><span class="p">)</span>
</code></pre></div>
<pre><code>files: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 14.0/14.0 [00:00&lt;00:00, 177files/s]


â ‹ Pushing metadata to the git repositoryâ ™ Pushing metadata to the git repository
</code></pre>
<h4 id="amount-of-files-in-the-buket-after-pushing-the-famous-dataset">Amount of files in the buket after pushing the famous dataset<a class="headerlink" href="#amount-of-files-in-the-buket-after-pushing-the-famous-dataset" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="n">get_bucket_files_count</span><span class="p">()</span>
</code></pre></div>
<pre><code>Number of files on bucket: 24
</code></pre>
<p>As you can see, only 4 blobs were added to our bucket. Of the set of 7 images, only 2 images were different from the other dataset, so ml-git can optimize storage by adding blobs related only to these new images.</p>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">August 18, 2022</span>
      
    
  </small>
</div>




              
            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.tabs", "toc.integrate"], "search": "../../../../assets/javascripts/workers/search.ecf98df9.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.9c69f0bc.min.js"></script>
      
    
  </body>
</html>