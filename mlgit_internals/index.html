
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://hpinc.github.io/ml-git/mlgit_internals/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.4.0">
    
    
      
        <title>Design - ML-Git</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.69437709.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.cbb835fc.min.css">
        
          
          
          <meta name="theme-color" content="#02a6f2">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="light-blue" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ml-git-architecture-and-internals" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="ML-Git" class="md-header__button md-logo" aria-label="ML-Git" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ML-Git
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Design
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link md-tabs__link--active">
        Home
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../developer_info/" class="md-tabs__link">
      Contributing to ML-Git
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="ML-Git" class="md-nav__button md-logo" aria-label="ML-Git" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    ML-Git
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_1">
          Home
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Home" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Home
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../first_steps/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../advanced_scenarios/" class="md-nav__link">
        Additional Use Cases
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_4" type="checkbox" id="__nav_1_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_1_4">
          Architecture
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Architecture" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_4">
          <span class="md-nav__icon md-icon"></span>
          Architecture
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Design
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Design
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#metadata-data-decoupling" class="md-nav__link">
    Metadata &amp; data decoupling
  </a>
  
    <nav class="md-nav" aria-label="Metadata &amp; data decoupling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cas-for-ml-git" class="md-nav__link">
    CAS for ML-Git
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-slicing-files-in-chunks" class="md-nav__link">
    Why slicing files in chunks?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#high-level-architecture-and-metadata" class="md-nav__link">
    High-level architecture and metadata
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ml-git-baseline-performance-numbers" class="md-nav__link">
    ML-Git baseline performance numbers
  </a>
  
    <nav class="md-nav" aria-label="ML-Git baseline performance numbers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#camseq01-under-ml-git" class="md-nav__link">
    CamSeq01 under ML-Git
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mscoco-all-files-under-ml-git" class="md-nav__link">
    MSCoco (all files) under ML-Git
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mscoco-zip-files-under-ml-git" class="md-nav__link">
    MSCoco (zip files) under ML-Git
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../centralized_cache_and_objects/" class="md-nav__link">
        Cache and Objects
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mutability_helper/" class="md-nav__link">
        Mutability Helper
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../plugins/" class="md-nav__link">
        Plugins
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../resources_initialization/" class="md-nav__link">
        Resources Initialization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tabular_data/tabular_data/" class="md-nav__link">
        Working With Tabular Data
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_5" type="checkbox" id="__nav_1_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_5">
          Supported Storages
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Supported Storages" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_5">
          <span class="md-nav__icon md-icon"></span>
          Supported Storages
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../storage_configurations/" class="md-nav__link">
        Configurations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../minio_s3_configuration/" class="md-nav__link">
        MinIO
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../aws_s3_configuration/" class="md-nav__link">
        S3
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../azure_configurations/" class="md-nav__link">
        Azure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gdrive_configurations/" class="md-nav__link">
        Google Drive
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_6" type="checkbox" id="__nav_1_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_6">
          Commands
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Commands" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_6">
          <span class="md-nav__icon md-icon"></span>
          Commands
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mlgit_commands/" class="md-nav__link">
        Using ML-Git CLI
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_6_2" type="checkbox" id="__nav_1_6_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_6_2">
          Using ML-Git API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Using ML-Git API" data-md-level="3">
        <label class="md-nav__title" for="__nav_1_6_2">
          <span class="md-nav__icon md-icon"></span>
          Using ML-Git API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/quick_start/" class="md-nav__link">
        Quick Start
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        Methods
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../downloadable_environment.md" class="md-nav__link">
        Docker Environment
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_8" type="checkbox" id="__nav_1_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1_8">
          ML-Git Step-by-Step Guides
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="ML-Git Step-by-Step Guides" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_8">
          <span class="md-nav__icon md-icon"></span>
          ML-Git Step-by-Step Guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../step_by_step_guides.md" class="md-nav__link">
        Summary
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/api_scripts_docs/basic/basic_flow/" class="md-nav__link">
        Basic Flow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/api_scripts_docs/basic/clone_repository/" class="md-nav__link">
        Clone Repository
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/api_scripts_docs/basic/multiple_projects/" class="md-nav__link">
        Multiple Projects
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/api_scripts_docs/relationship_notebook/relationship_api_commands/" class="md-nav__link">
        Relationship API Commands
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/api_scripts_docs/mnist_notebook/mnist_random_forest_api/" class="md-nav__link">
        MNIST Random Forest API
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/api_scripts_docs/mnist_notebook/mnist_random_forest_cli/" class="md-nav__link">
        MNIST Random Forest CLI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/api_scripts_docs/multiple_datasets_notebook/checkout_with_sample/" class="md-nav__link">
        Checkout With Sample
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/api_scripts_docs/multiple_datasets_notebook/multiple_datasets/" class="md-nav__link">
        Multiple Datasets
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../developer_info/" class="md-nav__link">
        Contributing to ML-Git
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="ml-git-architecture-and-internals">ML-Git: architecture and internals<a class="headerlink" href="#ml-git-architecture-and-internals" title="Permanent link">&para;</a></h1>
<h2 id="metadata-data-decoupling">Metadata &amp; data decoupling<a class="headerlink" href="#metadata-data-decoupling" title="Permanent link">&para;</a></h2>
<p>ML-Git's first design concept is to decouple the ML entities' metadata management from the actual data. So, the tool has two main layers:</p>
<ol>
<li>
<p>The metadata management, is responsible for organize the ML entities (Models, Datasets, and Labels) through specification files. Then, these files are managed by a git repository to store and retrieve versions of the ML entities. </p>
</li>
<li>
<p>The data storage, is responsible to keep the files of the ML entities.</p>
</li>
</ol>
<table>
<thead>
<tr>
<th align="center"><img alt="mlgit-cidv1" src="../mlgit-metadata-data.png" /></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><em>Figure 1. Decoupling Metadata &amp; Data Management Layers</em></td>
</tr>
</tbody>
</table>
<h3 id="cas-for-ml-git">CAS for ML-Git<a class="headerlink" href="#cas-for-ml-git" title="Permanent link">&para;</a></h3>
<p>ML-Git has been implemented as a Content Addressable Storage (CAS), meaning that we can retrieve the information based on the content and not based on the information's location.</p>
<table>
<thead>
<tr>
<th align="center"><img alt="mlgit-cidv1" src="../cidv1.png" /></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><em>Figure 2. Self-Describing Content-Addressed ID</em></td>
</tr>
</tbody>
</table>
<p>Figure 2 shows the basic principle of multihash to obtain a Content Identifier (CID) which is used under the hood by ML-Git to implement its CAS layer.</p>
<p>In a nutshell, CID is a self-describing content-addressed identifier that enables natural evolution and customization over simple and fixed cryptographic hashing schemes.
An argument why multihash is a valuable feature is that any cryptographic function ultimately ends being weak. It's been a challenge for many software to use another cryptographic hash (including git). For example, when collisions have been proven with SHA-1.</p>
<p>Summarizing, a CID is:</p>
<ul>
<li>A unique identifier/hash of “multihash” content.</li>
<li>Encoding the digest of the original content enabling anyone to retrieve thatcontent wherever it lies (through some routing).</li>
<li>Enabling the integrity check of the retrieved content (thx to multihash and the encoded digest).</li>
</ul>
<table>
<thead>
<tr>
<th align="center"><img alt="mlgit-cidv1" src="../IPLD-CID.png" /></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><em>Figure 3. IPLD - CID for a file</em></td>
</tr>
</tbody>
</table>
<p>There are a few steps to chunk a file to get an IPLD - CID format:</p>
<ol>
<li>Slide the file in piece of, say, 256KB.</li>
<li>For each slice, compute its digest (currently, ml-git uses sha2-256).</li>
<li>Obtain the CID for all these digests. These slice of files will be saved in a data storage with the computed CID as their filename. </li>
<li>Build a json describing all the chunks of the file.</li>
<li>Obtain the CID of that json. That json will also be saved in the data storage with the computed CID as its filename.</li>
</ol>
<p>Note that this last CID is the only piece of information you need to keep to retrieve the whole image.jpg file.
And last but not least, one can ensure the integrity of the file while downloading by computing the digests of all downloaded chunks and checking against the digest encoded in their CID.</p>
<p>Below, you can find useful links for more information on:</p>
<ul>
<li><a href="https://github.com/multiformats/multihash">Multihash</a> </li>
<li><a href="https://github.com/multiformats/cid">CID</a></li>
<li><a href="https://github.com/ipfs/js-ipfs/tree/master/examples/traverse-ipld-graphs">IPLD</a></li>
</ul>
<h3 id="why-slicing-files-in-chunks">Why slicing files in chunks?<a class="headerlink" href="#why-slicing-files-in-chunks" title="Permanent link">&para;</a></h3>
<p>IPFS uses small chunk size of 256KB … Why?</p>
<ul>
<li><strong>security</strong> - easy to DOS nodes without forcing small chunks</li>
<li><strong>deduplication</strong> - small chunks can dedup. big ones effectively dont.</li>
<li><strong>latency</strong> - can externalize small pieces already (think a stream)</li>
<li><strong>bandwidth</strong> - optimize the use of bandwidth across many peers</li>
<li><strong>performance</strong> - better perf to hold small pieces in memory. Hash along the dag to verify integrity of the whole thing.</li>
</ul>
<p>The big DOS problem with huge leaves is that malicious nodes can serve bogus stuff for a long time before a node can detect the problem (imagine having to download 4GB before you can check whether any of it is valid). This was super harmful for bittorrent (when people started choosing huge piece sizes), attackers would routinely do this, very cheaply - just serve bogus random data. This is why smaller chunks are used in our approach.</p>
<h2 id="high-level-architecture-and-metadata">High-level architecture and metadata<a class="headerlink" href="#high-level-architecture-and-metadata" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th align="center"><img alt="mlgit-arch-metadata" src="../ml-git--architecture-and-metadata.png" /></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><em>Figure 4. ML-Git high-level architecture and metadata relationships</em></td>
</tr>
</tbody>
</table>
<p>So IPLD/CID has been implemented on top of the storage.
The chunking strategy is a recommendation to turn S3 interactions more efficient when dealing with large files.
This approach is also valid when using the other supported storages: Azure, Google Drive, MinIO and SFTP.
It's also interesting to note that ML-Git implements a Thread pool to concurrently upload &amp; download files to the storage.
Taking into account the use of an S3 bucket, it would be possible to further accelerate ML-Git interactions with the bucket through the AWS CloudFront (not implemented yet).</p>
<h2 id="ml-git-baseline-performance-numbers">ML-Git baseline performance numbers<a class="headerlink" href="#ml-git-baseline-performance-numbers" title="Permanent link">&para;</a></h2>
<h3 id="camseq01-under-ml-git">CamSeq01 under ML-Git<a class="headerlink" href="#camseq01-under-ml-git" title="Permanent link">&para;</a></h3>
<ul>
<li>CamSeq01 size : 92MB</li>
<li>Locations: website in Cambridge -- S3 bucket in us-east-1 -- me in South Brazil</li>
<li>Download from website: ~4min22s</li>
<li>Upload to S3 with ml-git : 6m49s</li>
<li>Download to S3 with ml-git : 1m11s</li>
</ul>
<h3 id="mscoco-all-files-under-ml-git">MSCoco (all files) under ML-Git<a class="headerlink" href="#mscoco-all-files-under-ml-git" title="Permanent link">&para;</a></h3>
<ul>
<li>MSCoco :<ul>
<li>Size : 26GB</li>
<li>Number of files : 164065 ; chunked into ~400-500K blobs (todo: exact blob count)</li>
</ul>
</li>
<li>Locations: original dataset: unknown -- S3 bucket in us-east-1 -- me in South Brazil</li>
<li>Download from website: unknown</li>
<li>Upload to S3 with ml-git : 12h30m</li>
<li>Download to S3 with ml-git : 10h45m</li>
</ul>
<h3 id="mscoco-zip-files-under-ml-git">MSCoco (zip files) under ML-Git<a class="headerlink" href="#mscoco-zip-files-under-ml-git" title="Permanent link">&para;</a></h3>
<ul>
<li>MSCoco :<ul>
<li>Size : 25GB</li>
<li>number of files : 3 (train.zip, test.zip, val.zip) ; 102299 blobs</li>
</ul>
</li>
<li>Locations: original dataset: unknown -- S3 bucket in us-east-1 -- me in South Brazil</li>
<li>Download from website: unknown</li>
<li>Upload to S3 with ml-git : 4h35m</li>
<li>Download to S3 with ml-git : 3h39m</li>
</ul>
<p>A couple of comments:</p>
<ol>
<li>Even though Python GIL is a challenge for true concurrency in the Python interpreter, it still is very helpful and provides a significant improvement for ML-Git performance.</li>
<li>Not surprisingly, the number of files will affect the overall performance as it means there will be many more connections to AWS.
However, ML-Git have an option to download some dataset partially (checkout with sampling) to enable CI/CD workflows for which some ML engineers may run some experiments locally on their own machine.
For that reason, it is interesting to avoid downloading the full dataset if it's very large. This option is not applicable if the data set was loaded as some zip files.</li>
</ol>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">December 9, 2021</span>
      
    
  </small>
</div>




              
            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../advanced_scenarios/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Additional Use Cases" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Additional Use Cases
            </div>
          </div>
        </a>
      
      
        
        <a href="../centralized_cache_and_objects/" class="md-footer__link md-footer__link--next" aria-label="Next: Cache and Objects" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Cache and Objects
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "toc.integrate"], "search": "../assets/javascripts/workers/search.ecf98df9.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.9c69f0bc.min.js"></script>
      
    
  </body>
</html>